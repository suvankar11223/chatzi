# ğŸ—ï¸ Architecture Diagram: Unread Messages Feature

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MOBILE APP (Frontend)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Home Screen â”‚  â”‚ Conversation â”‚  â”‚ ConversationItem â”‚       â”‚
â”‚  â”‚              â”‚  â”‚    Screen    â”‚  â”‚   Component   â”‚          â”‚
â”‚  â”‚ - List chats â”‚  â”‚ - Messages   â”‚  â”‚ - Badge UI    â”‚          â”‚
â”‚  â”‚ - Sort by    â”‚  â”‚ - Send msg   â”‚  â”‚ - Bold text   â”‚          â”‚
â”‚  â”‚   latest     â”‚  â”‚ - Mark read  â”‚  â”‚ - Timestamp   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚                  â”‚                                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                    â”‚                                              â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚         â”‚   Socket.IO Client   â”‚                                 â”‚
â”‚         â”‚                       â”‚                                 â”‚
â”‚         â”‚ - newMessage          â”‚                                 â”‚
â”‚         â”‚ - getConversations    â”‚                                 â”‚
â”‚         â”‚ - markAsRead          â”‚                                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                    â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ WebSocket Connection
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BACKEND SERVER                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                  Socket.IO Server                         â”‚    â”‚
â”‚  â”‚                                                            â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚    â”‚
â”‚  â”‚  â”‚ newMessage  â”‚  â”‚getConversationsâ”‚ â”‚ markAsRead  â”‚      â”‚    â”‚
â”‚  â”‚  â”‚   Handler   â”‚  â”‚   Handler    â”‚  â”‚   Handler   â”‚      â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â”‚    â”‚
â”‚  â”‚         â”‚                 â”‚                  â”‚             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚            â”‚                 â”‚                  â”‚                   â”‚
â”‚            â”‚                 â”‚                  â”‚                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Business Logic                            â”‚  â”‚
â”‚  â”‚                                                               â”‚  â”‚
â”‚  â”‚  - Save message with readBy                                  â”‚  â”‚
â”‚  â”‚  - Increment unread count for receivers                      â”‚  â”‚
â”‚  â”‚  - Emit to conversation room                                 â”‚  â”‚
â”‚  â”‚  - Update conversation lastMessage                           â”‚  â”‚
â”‚  â”‚  - Reset unread count on markAsRead                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ MongoDB Queries
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MONGODB DATABASE                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Messages Collection â”‚         â”‚ Conversations Collection â”‚     â”‚
â”‚  â”‚                       â”‚         â”‚                       â”‚         â”‚
â”‚  â”‚  {                    â”‚         â”‚  {                    â”‚         â”‚
â”‚  â”‚    _id: ObjectId      â”‚         â”‚    _id: ObjectId      â”‚         â”‚
â”‚  â”‚    conversationId     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤    participants: []   â”‚         â”‚
â”‚  â”‚    senderId           â”‚         â”‚    lastMessage: ref   â”‚         â”‚
â”‚  â”‚    content            â”‚         â”‚    unreadCount: {     â”‚         â”‚
â”‚  â”‚    attachment         â”‚         â”‚      "userId": 3      â”‚         â”‚
â”‚  â”‚    readBy: []  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    }                  â”‚         â”‚
â”‚  â”‚    createdAt          â”‚         â”‚    updatedAt          â”‚         â”‚
â”‚  â”‚  }                    â”‚         â”‚  }                    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: Sending a Message

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User A     â”‚
â”‚  Device     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Sends message
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend (User A)                      â”‚
â”‚                                         â”‚
â”‚  - Optimistic update (instant UI)      â”‚
â”‚  - Emit "newMessage" via socket        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. Socket emission
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend                                â”‚
â”‚                                         â”‚
â”‚  - Receive "newMessage" event          â”‚
â”‚  - Save to MongoDB:                    â”‚
â”‚    * message.readBy = [senderId]       â”‚
â”‚  - Update conversation:                â”‚
â”‚    * unreadCount[userB] += 1           â”‚
â”‚    * lastMessage = messageId           â”‚
â”‚  - Emit to conversation room           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. Broadcast to room
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                  â”‚               â”‚
       â–¼                  â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User A     â”‚    â”‚  User B     â”‚  â”‚  User C     â”‚
â”‚  Device     â”‚    â”‚  Device     â”‚  â”‚  Device     â”‚
â”‚             â”‚    â”‚             â”‚  â”‚  (if group) â”‚
â”‚ - Replace   â”‚    â”‚ - Add msg   â”‚  â”‚ - Add msg   â”‚
â”‚   optimisticâ”‚    â”‚ - Move to   â”‚  â”‚ - Move to   â”‚
â”‚   message   â”‚    â”‚   TOP       â”‚  â”‚   TOP       â”‚
â”‚ - No badge  â”‚    â”‚ - Badge: 1  â”‚  â”‚ - Badge: 1  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: Opening a Conversation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User B     â”‚
â”‚  Device     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Opens conversation
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend (User B)                      â”‚
â”‚                                         â”‚
â”‚  - Navigate to conversation screen     â”‚
â”‚  - Emit "markAsRead" via socket        â”‚
â”‚  - Reset local unread count to 0       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. Socket emission
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend                                â”‚
â”‚                                         â”‚
â”‚  - Receive "markAsRead" event          â”‚
â”‚  - Update conversation:                â”‚
â”‚    * unreadCount[userB] = 0            â”‚
â”‚  - Update messages:                    â”‚
â”‚    * Add userB to readBy array         â”‚
â”‚  - Emit confirmation                   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. Confirmation
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend (User B)                      â”‚
â”‚                                         â”‚
â”‚  - Receive "markAsRead" confirmation   â”‚
â”‚  - Update home screen:                 â”‚
â”‚    * Remove badge                      â”‚
â”‚    * Text returns to normal            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Hierarchy

```
App
â”‚
â”œâ”€â”€ Home Screen
â”‚   â”‚
â”‚   â”œâ”€â”€ Conversation List (FlatList)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ConversationItem (User A) â† Has badge
â”‚   â”‚   â”‚   â”œâ”€â”€ Avatar
â”‚   â”‚   â”‚   â”œâ”€â”€ Name (Bold)
â”‚   â”‚   â”‚   â”œâ”€â”€ Last Message (Bold)
â”‚   â”‚   â”‚   â”œâ”€â”€ Timestamp (Primary color)
â”‚   â”‚   â”‚   â””â”€â”€ Badge (Shows "3")
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ConversationItem (User B) â† No badge
â”‚   â”‚   â”‚   â”œâ”€â”€ Avatar
â”‚   â”‚   â”‚   â”œâ”€â”€ Name (Regular)
â”‚   â”‚   â”‚   â”œâ”€â”€ Last Message (Gray)
â”‚   â”‚   â”‚   â””â”€â”€ Timestamp (Gray)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ConversationItem (User C) â† Has badge
â”‚   â”‚       â”œâ”€â”€ Avatar
â”‚   â”‚       â”œâ”€â”€ Name (Bold)
â”‚   â”‚       â”œâ”€â”€ Last Message (Bold)
â”‚   â”‚       â”œâ”€â”€ Timestamp (Primary color)
â”‚   â”‚       â””â”€â”€ Badge (Shows "1")
â”‚   â”‚
â”‚   â””â”€â”€ Socket Listeners
â”‚       â”œâ”€â”€ newMessage â†’ Update list, move to top
â”‚       â”œâ”€â”€ newConversation â†’ Add to list
â”‚       â””â”€â”€ markAsRead â†’ Remove badge
â”‚
â””â”€â”€ Conversation Screen
    â”‚
    â”œâ”€â”€ Message List (FlatList)
    â”‚   â”œâ”€â”€ MessageItem (User A)
    â”‚   â”œâ”€â”€ MessageItem (Me)
    â”‚   â””â”€â”€ MessageItem (User A)
    â”‚
    â”œâ”€â”€ Input Field
    â”‚
    â””â”€â”€ Socket Listeners
        â”œâ”€â”€ newMessage â†’ Add to list
        â”œâ”€â”€ getMessages â†’ Load history
        â””â”€â”€ markAsRead â†’ Emit on mount
```

---

## Socket Events Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Socket.IO Events                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  Client â†’ Server                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ newMessage                                          â”‚     â”‚
â”‚  â”‚   { conversationId, sender, content, attachment }  â”‚     â”‚
â”‚  â”‚                                                     â”‚     â”‚
â”‚  â”‚ getConversations                                    â”‚     â”‚
â”‚  â”‚   (no payload)                                      â”‚     â”‚
â”‚  â”‚                                                     â”‚     â”‚
â”‚  â”‚ markAsRead                                          â”‚     â”‚
â”‚  â”‚   { conversationId }                                â”‚     â”‚
â”‚  â”‚                                                     â”‚     â”‚
â”‚  â”‚ joinConversation                                    â”‚     â”‚
â”‚  â”‚   conversationId                                    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                               â”‚
â”‚  Server â†’ Client                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ newMessage                                          â”‚     â”‚
â”‚  â”‚   { success, data: { id, content, sender, ... } }  â”‚     â”‚
â”‚  â”‚                                                     â”‚     â”‚
â”‚  â”‚ getConversations                                    â”‚     â”‚
â”‚  â”‚   { success, data: [conversations with unread] }   â”‚     â”‚
â”‚  â”‚                                                     â”‚     â”‚
â”‚  â”‚ markAsRead                     